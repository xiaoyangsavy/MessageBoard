<html>
<head>
    <meta charset="UTF-8">
    <title>留言板</title>
    <link rel="stylesheet" type="text/css" href="../themes/default/easyui.css">  <!-- 组件显示样式 -->
    <link rel="stylesheet" type="text/css" href="../themes/icon.css">
    <script type="text/javascript" src="../js/jquery.min.js"></script>
    <script type="text/javascript" src="../js/jquery.easyui.min.js"></script>    <!--组件交互逻辑 -->
    <script type="text/javascript" src="../js/esayui-extend.js"></script>   <!-- 组件扩展功能 -->
    <script type="text/javascript" src="../js/common.js"></script>           <!-- 公共逻辑 -->


    <script type="text/javascript">

        //文档
        $(function() {
            var name = getCookie("u_name");
            $('#deng_lu').text(name);

            function Setcookie(name, value) {
                //设置名称为name,值为value的Cookie
                var expdate = new Date();   //初始化时间
                expdate.setTime(expdate.getTime() + 30 * 60 * 1000);   //时间
                document.cookie = name + "=" + value + ";expires=" + expdate.toGMTString() + ";path=/";
                //即document.cookie= name+"="+value+";path=/";   时间可以不要，但路径(path)必须要填写，因为JS的默认路径是当前页，如果不填，此cookie只在当前页面生效！~
            }

            //左侧菜单栏默认选中第一个
            var menus = $('#left-sidemenu');
            var opts = menus.sidemenu("options");
            changeMenuSelect(menus, opts, '_easyui_sidemenu_9');

            //首页加载数据
            $('#dg').datagrid({loadFilter:pagerFilter}).datagrid('loadData', getData());
        }      );

    </script>


<body id="mypannel" class="easyui-layout">
<div id="head" data-options="region:'north',border:false" style="height:60px;background:#B3DFDA;padding:10px;position:relative;">

    <script>
       $("#head").load("../view/head.html");
   </script>
    <button style="width:80px;height:20px;position:absolute;bottom:0;right: 0;background-color:#f6ab00;color:#ffffff;font-weight:bold"  onclick="logout()" >退出</button>
</div>
<div data-options="region:'west',split:true,title:'问题类型'" style="width:150px;padding:10px;">

    <div id="left-sidemenu" class="easyui-sidemenu" data-options="data:data,onSelect:selectItem"></div>

</div>
<div id="panel-center" data-options="region:'center',title:''">


<div style="margin:20px 0;"></div>
<div style="margin:70px 0 0 200px;">
	<table id="dg" class="easyui-datagrid" title="类型管理" style="width:850px;height:auto"
			data-options="
				iconCls: 'icon-edit',
				singleSelect: true,
				toolbar: '#tb',
				url: 'datagrid_data1.json',
				method: 'get',
				onClickRow: onClickRow
			">
		<thead>
			<tr>
            <th data-options="field:'status',width:50,align:'center',editor:{type:'checkbox',options:{on:'',off:''}}" style="text-align:center">Status</th>
				<!--  <th data-options="field:'itemid',width:80">ID</th>  -->
                <th 3 data-options="field:'itemid',width:400,editor:'textbox',align:'center'"  >编号</th>
                <th data-options="field:'type',width:400,editor:'textbox',align:'center'">类型名</th>
				<!--	<th data-options="field:'productid',width:100,
						formatter:function(value,row){
							return row.productname;
						},
						editor:{
							type:'combobox',
							options:{
								valueField:'productid',
								textField:'productname',
								method:'get',
								url:'./type.json',
								required:true
							}
						}">类型名</th>
			<th data-options="field:'listprice',width:80,align:'right',editor:{type:'numberbox',options:{precision:1}}">List Price</th>
				<th data-options="field:'unitcost',width:80,align:'right',editor:'numberbox'">Unit Cost</th>
				<th data-options="field:'attr1',width:250,editor:'textbox'">Attribute</th>-->
				
			</tr>
		</thead>
       <tr>
       <td></td>
         <td>001</td>
         <td>教务教学</td>
         
      </tr>
      <tr>
      <td></td>
         <td>002</td>
         <td>后勤服务</td>
      </tr>
      <tr>
      <td></td>
         <td>003</td>
         <td>学生管理</td>
      </tr>
      <tr>
      <td></td>
         <td>004</td>
         <td>书记信箱</td>
      </tr>
      <tr>
      <td></td>
         <td>005</td>
         <td>校长信箱</td>
      </tr>
	</table>
    </div>
 <table>
      
 </table>
	<div id="tb" style="height:auto;text-align:right">
		<a href="javascript:void(0)" class="easyui-linkbutton" data-options="iconCls:'icon-add',plain:true" onClick="append()">添加</a>
		<a href="javascript:void(0)" class="easyui-linkbutton" data-options="iconCls:'icon-remove',plain:true" onClick="removeit()">删除</a>
		<a href="javascript:void(0)" class="easyui-linkbutton" data-options="iconCls:'icon-save',plain:true" onClick="accept()">保存</a>
		<!--<a href="javascript:void(0)" class="easyui-linkbutton" data-options="iconCls:'icon-undo',plain:true" onclick="reject()">Reject</a>
		<a href="javascript:void(0)" class="easyui-linkbutton" data-options="iconCls:'icon-search',plain:true" onclick="getChanges()">GetChanges</a>-->
	</div>



</div>
<script type="text/javascript">
		var editIndex = undefined;
		function endEditing(){
			if (editIndex == undefined){return true}
			if ($('#dg').datagrid('validateRow', editIndex)){
				var ed = $('#dg').datagrid('getEditor', {index:editIndex,field:'itemid'});
				var productname = $(ed.target).combobox('getText');
				$('#dg').datagrid('getRows')[editIndex]['productname'] = productname;
				$('#dg').datagrid('endEdit', editIndex);
				editIndex = undefined;
				return true;
			} else {
				return false;
			}
		}
		function onClickRow(index){
			if (editIndex != index){
				if (endEditing()){
					$('#dg').datagrid('selectRow', index)
							.datagrid('beginEdit', index);
					editIndex = index;
				} else {
					$('#dg').datagrid('selectRow', editIndex);
				}
			}
		}
		function append(){
			if (endEditing()){
				$('#dg').datagrid('appendRow',{status:'P'});
				editIndex = $('#dg').datagrid('getRows').length-1;
				$('#dg').datagrid('selectRow', editIndex)
						.datagrid('beginEdit', editIndex);
			}
		}
		function removeit(){
			if (editIndex == undefined){return}
			$('#dg').datagrid('cancelEdit', editIndex)
					.datagrid('deleteRow', editIndex);
			editIndex = undefined;
		}
		function accept(){
			if (endEditing()){
				$('#dg').datagrid('acceptChanges');
			}
		}
		function reject(){
			$('#dg').datagrid('rejectChanges');
			editIndex = undefined;
		}
		function getChanges(){
			var rows = $('#dg').datagrid('getChanges');
			alert(rows.length+' rows are changed!');
		}
	</script>
</body>
</html>